## 07 | 变量提升：JavaScript 代码是按顺序执行的吗？

1. 变量提升

   **声明与赋值**

   ```javascript
   var name = 'tom'  
   
   //编译后
   var name //声明
   name = 'tom'  //赋值
   ```

   `变量提升，是指在 JavaScript 代码执行过程中，JavaScript 引擎把变量的声明部分和函数的声明部分提升到代码开头的“行为”。变量被提升后，会给变量设置默认值，这个默认值就是我们熟悉的 undefined。`

   函数和变量在执行之前都提升到了代码开头。

   ```javascript
   showName()
   console.log(name)
   var name = 'tom'
   function showName(){
     console.log('showName')
   }
   
   //模拟变量提升
   变量提升部分
   var name = undefined
   function showName(){
     console.log('showName')
   }
   可执行代码部分
   showName()
   console.log(name)
   name = 'tom'
   ```

2. Javascript代码的执行流程

   <font color="red">实际上变量和函数声明在代码里的位置是不会改变的，而且是在编译阶段被 JavaScript 引擎放入内存中。</font>

   一段 JavaScript 代码在执行之前需要被 JavaScript 引擎编译，编译完成之后，才会进入执行阶段.

   一段js代码 ===》编译阶段===》执行阶段

   - 编译阶段

     > 代码编译后，会生成两部分：执行上下文和可执行代码
     >
     > 执行上下文：js执行一段代码时运行环境
     >
     > 执行环境中有变量环境和词法环境，变量环境保存了变量提升的内容

   - 执行环境

     > JavaScript 引擎开始执行“可执行代码”，按照顺序一行一行地执行

3. 代码中出现相同的变量或函数怎么办？

   <font color="red">一段代码如果定义了两个相同名字的函数，那么最终生效的是最后一个函数。</font>

   ```javascript
   
   function showName() {
       console.log('极客邦');
   }
   showName();
   function showName() {
       console.log('极客时间');
   }
   showName(); 
   
   //打印两次 极客时间
   //编译阶段，两个同名函数，后者覆盖前者，之后是执行阶段，第一次调用函数，在变量环境中找到的也是第二个函数，所以调用的也是第二个
   
   ```

**思考题：下面代码的输出结果**

```javascript
showName()  //进入执行环境
var showName = function() { // var showName = undefined 进入变量环境
    console.log(2)			// 执行环境 ： showName = function(){console.log(2)}
}
function showName() {  //进入变量环境
    console.log(1)
}

//输出1

编译阶段:
var showName
function showName(){console.log(1)}

执行阶段:
showName()//输出1
showName=function(){console.log(2)}
//如果后面再有showName执行的话，就输出2因为这时候函数引用已经变了
```

**疑问：如果同名的变量和函数名，变量环境中是分别保存还是如何处理的？**

> 1. 如果是同名的函数，JavaScript编译阶段会选择最后声明的那个。
>
> 2. 如果变量和函数同名，那么在编译阶段，变量的声明会被忽略
>
> 3. 函数提升要比变量提升的优先级要高一些，且不会被变量声明覆盖，但是会被变量赋值之后覆盖。









